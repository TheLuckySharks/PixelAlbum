{"ast":null,"code":"import _toConsumableArray from\"/Users/am/Desktop/PixelAlbum/PixelAlbum/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"/Users/am/Desktop/PixelAlbum/PixelAlbum/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{event}from\"react-ga\";import React from\"react\";import _ from\"lodash\";import{BrowserRouter as Router,Routes,Route}from\"react-router-dom\";import{todaysSolution}from\"./helpers\";import{Header,InfoPopUp,Game}from\"./components\";import*as Styled from\"./app.styled\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function App(){var initialGuess={song:undefined,skipped:false,isCorrect:undefined};var _React$useState=React.useState(Array.from({length:5}).fill(initialGuess)),_React$useState2=_slicedToArray(_React$useState,2),guesses=_React$useState2[0],setGuesses=_React$useState2[1];var _React$useState3=React.useState(0),_React$useState4=_slicedToArray(_React$useState3,2),currentTry=_React$useState4[0],setCurrentTry=_React$useState4[1];var _React$useState5=React.useState(),_React$useState6=_slicedToArray(_React$useState5,2),selectedSong=_React$useState6[0],setSelectedSong=_React$useState6[1];var _React$useState7=React.useState(false),_React$useState8=_slicedToArray(_React$useState7,2),didGuess=_React$useState8[0],setDidGuess=_React$useState8[1];var firstRun=localStorage.getItem(\"firstRun\")===null;var stats=JSON.parse(localStorage.getItem(\"stats\")||\"{}\");React.useEffect(function(){if(Array.isArray(stats)){var visitedToday=_.isEqual(todaysSolution,stats[stats.length-1].solution);if(!visitedToday){stats.push({solution:todaysSolution,currentTry:0,didGuess:0});}else{var _stats=stats[stats.length-1],_currentTry=_stats.currentTry,_guesses=_stats.guesses,_didGuess=_stats.didGuess;setCurrentTry(_currentTry);setGuesses(_guesses);setDidGuess(_didGuess);}}else{// initialize stats\n// useEffect below does rest\nstats=[];stats.push({solution:todaysSolution});}},[]);React.useEffect(function(){if(Array.isArray(stats)){stats[stats.length-1].currentTry=currentTry;stats[stats.length-1].didGuess=didGuess;stats[stats.length-1].guesses=guesses;}},[guesses,currentTry,didGuess]);React.useEffect(function(){localStorage.setItem(\"stats\",JSON.stringify(stats));},[stats]);var _React$useState9=React.useState(firstRun),_React$useState10=_slicedToArray(_React$useState9,2),isInfoPopUpOpen=_React$useState10[0],setIsInfoPopUpOpen=_React$useState10[1];var openInfoPopUp=React.useCallback(function(){setIsInfoPopUpOpen(true);},[]);var closeInfoPopUp=React.useCallback(function(){if(firstRun){localStorage.setItem(\"firstRun\",\"false\");setIsInfoPopUpOpen(false);}else{setIsInfoPopUpOpen(false);}},[localStorage.getItem(\"firstRun\")]);var skip=React.useCallback(function(){setGuesses(function(guesses){var newGuesses=_toConsumableArray(guesses);newGuesses[currentTry]={song:undefined,skipped:true,isCorrect:undefined};return newGuesses;});setCurrentTry(function(currentTry){return currentTry+1;});event({category:\"Game\",action:\"Skip\"});},[currentTry]);var guess=React.useCallback(function(){var isCorrect=selectedSong===todaysSolution;if(!selectedSong){alert(\"Choose a song\");return;}setGuesses(function(guesses){var newGuesses=_toConsumableArray(guesses);newGuesses[currentTry]={song:selectedSong,skipped:false,isCorrect:isCorrect};return newGuesses;});setCurrentTry(function(currentTry){return currentTry+1;});setSelectedSong(undefined);if(isCorrect){setDidGuess(true);}event({category:\"Game\",action:\"Guess\",label:\"\".concat(selectedSong.artist,\" - \").concat(selectedSong.name),value:isCorrect?1:0});},[guesses,selectedSong]);return/*#__PURE__*/_jsx(\"main\",{children:/*#__PURE__*/_jsx(Router,{children:/*#__PURE__*/_jsx(Routes,{children:/*#__PURE__*/_jsx(Route,{path:\"/\",element:/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(Styled.Container,{children:[isInfoPopUpOpen&&/*#__PURE__*/_jsx(InfoPopUp,{onClose:closeInfoPopUp}),/*#__PURE__*/_jsx(Header,{openInfoPopUp:openInfoPopUp}),/*#__PURE__*/_jsx(Game,{guesses:guesses,didGuess:didGuess,todaysSolution:todaysSolution,currentTry:currentTry,setSelectedSong:setSelectedSong,skip:skip,guess:guess})]})})})})})});}export default App;","map":{"version":3,"sources":["/Users/am/Desktop/PixelAlbum/PixelAlbum/src/app.tsx"],"names":["event","React","_","BrowserRouter","Router","Routes","Route","todaysSolution","Header","InfoPopUp","Game","Styled","App","initialGuess","song","undefined","skipped","isCorrect","useState","Array","from","length","fill","guesses","setGuesses","currentTry","setCurrentTry","selectedSong","setSelectedSong","didGuess","setDidGuess","firstRun","localStorage","getItem","stats","JSON","parse","useEffect","isArray","visitedToday","isEqual","solution","push","setItem","stringify","isInfoPopUpOpen","setIsInfoPopUpOpen","openInfoPopUp","useCallback","closeInfoPopUp","skip","newGuesses","category","action","guess","alert","label","artist","name","value"],"mappings":"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","sourcesContent":["import { event } from \"react-ga\";\n\nimport React from \"react\";\nimport _ from \"lodash\";\n\nimport { BrowserRouter as Router, Routes, Route } from \"react-router-dom\";\n\nimport { Song } from \"./types/song\";\nimport { GuessType } from \"./types/guess\";\n\nimport { todaysSolution } from \"./helpers\";\n\nimport { Header, InfoPopUp, Game } from \"./components\";\n\nimport * as Styled from \"./app.styled\";\n\nfunction App() {\n  const initialGuess = {\n    song: undefined,\n    skipped: false,\n    isCorrect: undefined,\n  } as GuessType;\n\n  const [guesses, setGuesses] = React.useState<GuessType[]>(\n    Array.from({ length: 5 }).fill(initialGuess) as GuessType[]\n  );\n  const [currentTry, setCurrentTry] = React.useState<number>(0);\n  const [selectedSong, setSelectedSong] = React.useState<Song>();\n  const [didGuess, setDidGuess] = React.useState<boolean>(false);\n\n  const firstRun = localStorage.getItem(\"firstRun\") === null;\n  let stats = JSON.parse(localStorage.getItem(\"stats\") || \"{}\");\n\n  React.useEffect(() => {\n    if (Array.isArray(stats)) {\n      const visitedToday = _.isEqual(\n        todaysSolution,\n        stats[stats.length - 1].solution\n      );\n\n      if (!visitedToday) {\n        stats.push({\n          solution: todaysSolution,\n          currentTry: 0,\n          didGuess: 0,\n        });\n      } else {\n        const { currentTry, guesses, didGuess } = stats[stats.length - 1];\n        setCurrentTry(currentTry);\n        setGuesses(guesses);\n        setDidGuess(didGuess);\n      }\n    } else {\n      // initialize stats\n      // useEffect below does rest\n      stats = [];\n      stats.push({\n        solution: todaysSolution,\n      });\n    }\n  }, []);\n\n  React.useEffect(() => {\n    if (Array.isArray(stats)) {\n      stats[stats.length - 1].currentTry = currentTry;\n      stats[stats.length - 1].didGuess = didGuess;\n      stats[stats.length - 1].guesses = guesses;\n    }\n  }, [guesses, currentTry, didGuess]);\n\n  React.useEffect(() => {\n    localStorage.setItem(\"stats\", JSON.stringify(stats));\n  }, [stats]);\n\n  const [isInfoPopUpOpen, setIsInfoPopUpOpen] =\n    React.useState<boolean>(firstRun);\n\n  const openInfoPopUp = React.useCallback(() => {\n    setIsInfoPopUpOpen(true);\n  }, []);\n\n  const closeInfoPopUp = React.useCallback(() => {\n    if (firstRun) {\n      localStorage.setItem(\"firstRun\", \"false\");\n      setIsInfoPopUpOpen(false);\n    } else {\n      setIsInfoPopUpOpen(false);\n    }\n  }, [localStorage.getItem(\"firstRun\")]);\n\n  const skip = React.useCallback(() => {\n    setGuesses((guesses: GuessType[]) => {\n      const newGuesses = [...guesses];\n      newGuesses[currentTry] = {\n        song: undefined,\n        skipped: true,\n        isCorrect: undefined,\n      };\n\n      return newGuesses;\n    });\n\n    setCurrentTry((currentTry) => currentTry + 1);\n\n    event({\n      category: \"Game\",\n      action: \"Skip\",\n    });\n  }, [currentTry]);\n\n  const guess = React.useCallback(() => {\n    const isCorrect = selectedSong === todaysSolution;\n\n    if (!selectedSong) {\n      alert(\"Choose a song\");\n      return;\n    }\n\n    setGuesses((guesses: GuessType[]) => {\n      const newGuesses = [...guesses];\n      newGuesses[currentTry] = {\n        song: selectedSong,\n        skipped: false,\n        isCorrect: isCorrect,\n      };\n\n      return newGuesses;\n    });\n\n    setCurrentTry((currentTry) => currentTry + 1);\n    setSelectedSong(undefined);\n\n    if (isCorrect) {\n      setDidGuess(true);\n    }\n\n    event({\n      category: \"Game\",\n      action: \"Guess\",\n      label: `${selectedSong.artist} - ${selectedSong.name}`,\n      value: isCorrect ? 1 : 0,\n    });\n  }, [guesses, selectedSong]);\n\n  return (\n    <main>\n      <Router>\n        <Routes>\n          <Route\n            path=\"/\"\n            element={\n              <>\n                <Styled.Container>\n                  {isInfoPopUpOpen && <InfoPopUp onClose={closeInfoPopUp} />}\n                  <Header openInfoPopUp={openInfoPopUp} />\n                  <Game\n                    guesses={guesses}\n                    didGuess={didGuess}\n                    todaysSolution={todaysSolution}\n                    currentTry={currentTry}\n                    setSelectedSong={setSelectedSong}\n                    skip={skip}\n                    guess={guess}\n                  />\n                </Styled.Container>\n              </>\n            }\n          />\n        </Routes>\n      </Router>\n    </main>\n  );\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}